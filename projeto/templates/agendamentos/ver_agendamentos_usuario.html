{% extends "base.html" %}
{% block title %}Meus Agendamentos{% endblock %}

{% load static %}

{% block content %}
    <br>
    <h2>Meus Agendamentos</h2>
    <br>

    {% if agendamentos %}
    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr style="background-color: #5db467; color: white;">
                    <th>C√≥digo</th>
                    <th>Nome</th>
                    <th>Tipos de res√≠duos</th>
                    <th>Detalhes</th>
                    <th>Etapa Atual</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody>
                {% for agendamento in agendamentos %}
                    <tr>
                        <td>#{{ agendamento.id }}</td>
                        <td>{{ agendamento.nome }}</td>
                        <td>{{ agendamento.tipos_residuos }}</td>
                        <td>
                            <p>{{ agendamento.endereco }}</p>
                            <p>{{ agendamento.data }} - {{ agendamento.hora }}h</p>
                        </td>
                        <td>
                            <!-- Exibe a Etapa Atual dinamicamente -->
                            <span class="badge badge-primary">
                                {{ agendamento.get_etapa_display|default:"Solicita√ß√£o de Agendamento" }}
                            </span>
                        </td>
                        <td>
                            <!-- Bot√£o de Edi√ß√£o -->
                            <form action="{% url 'agendamentos:editar_agendamento' agendamento.id %}" method="GET" style="display:inline;">
                                <button type="submit" class="btn btn-warning btn-sm">‚úèÔ∏è Editar</button>
                            </form>
                            
                            <!-- Bot√£o de Exclus√£o -->
                            <form action="{% url 'agendamentos:delete_user_appointment' agendamento.id %}" method="POST" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Tem certeza que deseja excluir este agendamento?');">
                                    üóëÔ∏è Excluir
                                </button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="text-align: center; margin-top: 20px;">
        <p>N√£o h√° agendamentos.</p>
    </div>
    {% endif %}
{% endblock %}
